FIT Profiler Report

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                 	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                  	|  -              	|  271141         	|  6956.3         	|  100 %          	|
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                     	|  34.56          	|  200            	|  6911.9         	|  99.362         	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                             	|  0.25297        	|  7200           	|  1821.3         	|  26.183         	|
|  run_training_batch                                                                                                                                                     	|  0.16596        	|  7200           	|  1194.9         	|  17.178         	|
|  [LightningModule]Toymodel.optimizer_step                                                                                                                               	|  0.16578        	|  7200           	|  1193.6         	|  17.158         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                           	|  0.15596        	|  7200           	|  1122.9         	|  16.142         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                         	|  0.082223       	|  7842           	|  644.79         	|  9.2691         	|
|  [LightningModule]Toymodel.transfer_batch_to_device                                                                                                                     	|  0.082141       	|  7842           	|  644.15         	|  9.2599         	|
|  [LightningModule]Toymodel.on_validation_epoch_start                                                                                                                    	|  10.791         	|  41             	|  442.44         	|  6.3602         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                           	|  0.026752       	|  7200           	|  192.61         	|  2.7689         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                	|  0.0083896      	|  7200           	|  60.405         	|  0.86834        	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  0.202          	|  41             	|  8.282          	|  0.11906        	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                         	|  0.0096059      	|  642            	|  6.167          	|  0.088653       	|
|  [LightningModule]Toymodel.optimizer_zero_grad                                                                                                                          	|  0.0002325      	|  7200           	|  1.674          	|  0.024064       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                      	|  0.0017072      	|  642            	|  1.096          	|  0.015755       	|
|  [_EvaluationLoop].val_next                                                                                                                                             	|  0.001703       	|  643            	|  1.095          	|  0.015741       	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                          	|  0.020561       	|  41             	|  0.843          	|  0.012118       	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  2.5556e-05     	|  7200           	|  0.184          	|  0.0026451      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                           	|  0.000875       	|  200            	|  0.175          	|  0.0025157      	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                    	|  0.00026791     	|  642            	|  0.172          	|  0.0024726      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                            	|  0.003          	|  41             	|  0.123          	|  0.0017682      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                         	|  0.00046        	|  200            	|  0.092          	|  0.0013225      	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                            	|  1.1111e-05     	|  7200           	|  0.08           	|  0.00115        	|
|  [LightningModule]Toymodel.configure_gradient_clipping                                                                                                                  	|  1.0833e-05     	|  7200           	|  0.078          	|  0.0011213      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                         	|  1.0694e-05     	|  7200           	|  0.077          	|  0.0011069      	|
|  [LightningModule]Toymodel.on_validation_epoch_end                                                                                                                      	|  0.001122       	|  41             	|  0.046          	|  0.00066127     	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                              	|  4.4444e-06     	|  7200           	|  0.032          	|  0.00046001     	|
|  [LightningModule]Toymodel.on_before_batch_transfer                                                                                                                     	|  4.0806e-06     	|  7842           	|  0.032          	|  0.00046001     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                              	|  4.4444e-06     	|  7200           	|  0.032          	|  0.00046001     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  4.3056e-06     	|  7200           	|  0.031          	|  0.00044564     	|
|  [LightningModule]Toymodel.on_train_batch_start                                                                                                                         	|  4.3056e-06     	|  7200           	|  0.031          	|  0.00044564     	|
|  [LightningModule]Toymodel.on_validation_model_eval                                                                                                                     	|  0.00073171     	|  41             	|  0.03           	|  0.00043126     	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                             	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [LightningModule]Toymodel.on_after_backward                                                                                                                            	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                     	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                        	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                          	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                           	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [LightningModule]Toymodel.on_before_optimizer_step                                                                                                                     	|  2.2222e-06     	|  7200           	|  0.016          	|  0.00023001     	|
|  [LightningModule]Toymodel.lr_scheduler_step                                                                                                                            	|  8e-05          	|  200            	|  0.016          	|  0.00023001     	|
|  [LightningModule]Toymodel.on_after_batch_transfer                                                                                                                      	|  1.9128e-06     	|  7842           	|  0.015          	|  0.00021563     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  2.3364e-05     	|  642            	|  0.015          	|  0.00021563     	|
|  [LightningModule]Toymodel.on_before_zero_grad                                                                                                                          	|  2.0833e-06     	|  7200           	|  0.015          	|  0.00021563     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  2.0833e-06     	|  7200           	|  0.015          	|  0.00021563     	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                               	|  2.0833e-06     	|  7200           	|  0.015          	|  0.00021563     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  2.0833e-06     	|  7200           	|  0.015          	|  0.00021563     	|
|  [LightningModule]Toymodel.configure_callbacks                                                                                                                          	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.prepare_data                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.setup                                                                                                                                           	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.setup                                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.configure_sharded_model                                                                                                                      	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.configure_optimizers                                                                                                                         	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_fit_start                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                           	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                             	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_start                                                                                                                          	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                     	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                    	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                       	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                       	|  0.0            	|  642            	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  0.0            	|  642            	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_batch_start                                                                                                                    	|  0.0            	|  642            	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                         	|  0.0            	|  642            	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_batch_end                                                                                                                      	|  0.0            	|  642            	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                      	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                         	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                               	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_end                                                                                                                            	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                       	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_model_train                                                                                                                    	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                          	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                             	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                               	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                  	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_start                                                                                                                               	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                          	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                            	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_epoch_start                                                                                                                         	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                            	|  0.0            	|  7200           	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  0.0            	|  7200           	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                    	|  0.0            	|  7200           	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_before_backward                                                                                                                           	|  0.0            	|  7200           	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  0.0            	|  7200           	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_batch_end                                                                                                                           	|  0.0            	|  7200           	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                              	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_epoch_end                                                                                                                           	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                           	|  0.0            	|  24             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                              	|  0.0            	|  24             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  0.0            	|  24             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_save_checkpoint                                                                                                                           	|  0.0            	|  24             	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_end                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                            	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                   	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                      	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_fit_end                                                                                                                                   	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                     	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.teardown                                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.teardown                                                                                                                                     	|  0.0            	|  1              	|  0.0            	|  0.0            	|
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
