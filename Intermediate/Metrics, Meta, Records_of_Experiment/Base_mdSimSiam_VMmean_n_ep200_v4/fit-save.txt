FIT Profiler Report

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                 	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                  	|  -              	|  1429401        	|  7264.7         	|  100 %          	|
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                     	|  36.169         	|  200            	|  7233.8         	|  99.574         	|
|  run_training_batch                                                                                                                                                     	|  0.057577       	|  39000          	|  2245.5         	|  30.91          	|
|  [LightningModule]Toymodel.optimizer_step                                                                                                                               	|  0.057284       	|  39000          	|  2234.1         	|  30.752         	|
|  [_TrainingEpochLoop].train_dataloader_next                                                                                                                             	|  0.047174       	|  39000          	|  1839.8         	|  25.325         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                           	|  0.038529       	|  39000          	|  1502.6         	|  20.684         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                	|  0.017576       	|  39000          	|  685.46         	|  9.4355         	|
|  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                           	|  0.014924       	|  39000          	|  582.05         	|  8.012          	|
|  [LightningModule]Toymodel.on_validation_epoch_start                                                                                                                    	|  8.0712         	|  41             	|  330.92         	|  4.5552         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                         	|  0.0047675      	|  40602          	|  193.57         	|  2.6645         	|
|  [LightningModule]Toymodel.transfer_batch_to_device                                                                                                                     	|  0.0047308      	|  40602          	|  192.08         	|  2.644          	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                         	|  0.00801        	|  1602           	|  12.832         	|  0.17663        	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  0.24583        	|  41             	|  10.079         	|  0.13874        	|
|  [LightningModule]Toymodel.optimizer_zero_grad                                                                                                                          	|  0.00014918     	|  39000          	|  5.818          	|  0.080086       	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                      	|  0.0034157      	|  1602           	|  5.472          	|  0.075323       	|
|  [_EvaluationLoop].val_next                                                                                                                                             	|  0.0011454      	|  1603           	|  1.836          	|  0.025273       	|
|  [LightningModule]Toymodel.configure_gradient_clipping                                                                                                                  	|  1.9231e-05     	|  39000          	|  0.75           	|  0.010324       	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_end       	|  1.3872e-05     	|  39000          	|  0.541          	|  0.0074469      	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                     	|  3.9231e-06     	|  39000          	|  0.153          	|  0.0021061      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                           	|  0.00071        	|  200            	|  0.142          	|  0.0019546      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                         	|  0.000705       	|  200            	|  0.141          	|  0.0019409      	|
|  [LightningModule]Toymodel.on_after_backward                                                                                                                            	|  3.2308e-06     	|  39000          	|  0.126          	|  0.0017344      	|
|  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                         	|  3.2308e-06     	|  39000          	|  0.126          	|  0.0017344      	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                            	|  3.1795e-06     	|  39000          	|  0.124          	|  0.0017069      	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                          	|  3.1282e-06     	|  39000          	|  0.122          	|  0.0016793      	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                           	|  2.7949e-06     	|  39000          	|  0.109          	|  0.0015004      	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                               	|  2.4103e-06     	|  39000          	|  0.094          	|  0.0012939      	|
|  [LightningModule]Toymodel.on_before_backward                                                                                                                           	|  2.0513e-06     	|  39000          	|  0.08           	|  0.0011012      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                          	|  0.001878       	|  41             	|  0.077          	|  0.0010599      	|
|  [LightningModule]Toymodel.on_after_batch_transfer                                                                                                                      	|  1.5763e-06     	|  40602          	|  0.064          	|  0.00088097     	|
|  [LightningModule]Toymodel.on_validation_epoch_end                                                                                                                      	|  0.001561       	|  41             	|  0.064          	|  0.00088097     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_zero_grad      	|  1.6154e-06     	|  39000          	|  0.063          	|  0.0008672      	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                    	|  1.6154e-06     	|  39000          	|  0.063          	|  0.0008672      	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_optimizer_step 	|  1.6154e-06     	|  39000          	|  0.063          	|  0.0008672      	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_batch_start     	|  1.5897e-06     	|  39000          	|  0.062          	|  0.00085344     	|
|  [LightningModule]Toymodel.on_before_batch_transfer                                                                                                                     	|  1.527e-06      	|  40602          	|  0.062          	|  0.00085344     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_after_backward        	|  1.5897e-06     	|  39000          	|  0.062          	|  0.00085344     	|
|  [Callback]ModelSummary.on_train_batch_start                                                                                                                            	|  1.5641e-06     	|  39000          	|  0.061          	|  0.00083967     	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                    	|  2.9963e-05     	|  1602           	|  0.048          	|  0.00066073     	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_before_backward       	|  1.2051e-06     	|  39000          	|  0.047          	|  0.00064696     	|
|  [LightningModule]Toymodel.on_train_batch_start                                                                                                                         	|  1.1795e-06     	|  39000          	|  0.046          	|  0.0006332      	|
|  [Callback]ModelSummary.on_train_batch_end                                                                                                                              	|  1.1538e-06     	|  39000          	|  0.045          	|  0.00061943     	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                        	|  8.2051e-07     	|  39000          	|  0.032          	|  0.00044048     	|
|  [LightningModule]Toymodel.on_validation_model_train                                                                                                                    	|  0.00078049     	|  41             	|  0.032          	|  0.00044048     	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                            	|  0.0007561      	|  41             	|  0.031          	|  0.00042672     	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                             	|  7.9487e-07     	|  39000          	|  0.031          	|  0.00042672     	|
|  [LightningModule]Toymodel.on_train_batch_end                                                                                                                           	|  7.6923e-07     	|  39000          	|  0.03           	|  0.00041295     	|
|  [LightningModule]Toymodel.on_validation_model_eval                                                                                                                     	|  0.00039024     	|  41             	|  0.016          	|  0.00022024     	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                              	|  4.1026e-07     	|  39000          	|  0.016          	|  0.00022024     	|
|  [LightningModule]Toymodel.on_before_zero_grad                                                                                                                          	|  3.8462e-07     	|  39000          	|  0.015          	|  0.00020648     	|
|  [LightningModule]Toymodel.on_before_optimizer_step                                                                                                                     	|  3.8462e-07     	|  39000          	|  0.015          	|  0.00020648     	|
|  [LightningModule]Toymodel.lr_scheduler_step                                                                                                                            	|  7.5e-05        	|  200            	|  0.015          	|  0.00020648     	|
|  [LightningModule]Toymodel.configure_callbacks                                                                                                                          	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.prepare_data                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.setup                                                                                                                                           	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.setup                                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.configure_sharded_model                                                                                                                      	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.configure_optimizers                                                                                                                         	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_start             	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_fit_start                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                           	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_start    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                             	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_start                                                                                                                          	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                     	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                    	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                       	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                       	|  0.0            	|  1602           	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  0.0            	|  1602           	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_batch_start                                                                                                                    	|  0.0            	|  1602           	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                         	|  0.0            	|  1602           	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  0.0            	|  1602           	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_batch_end                                                                                                                      	|  0.0            	|  1602           	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                      	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                         	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                               	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_validation_end                                                                                                                            	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                       	|  0.0            	|  41             	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                          	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                             	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_sanity_check_end      	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                               	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                  	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_start           	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_start                                                                                                                               	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                          	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                            	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_start     	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_epoch_start                                                                                                                         	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                              	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_epoch_end                                                                                                                           	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_epoch_end       	|  0.0            	|  200            	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                           	|  0.0            	|  29             	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                              	|  0.0            	|  29             	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_save_checkpoint       	|  0.0            	|  29             	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_save_checkpoint                                                                                                                           	|  0.0            	|  29             	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                    	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_train_end             	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_train_end                                                                                                                                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                            	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                   	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                      	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_fit_end               	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.on_fit_end                                                                                                                                   	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                     	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelSummary.teardown                                                                                                                                        	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [Callback]ModelCheckpoint{'monitor': 'train_loss', 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  0.0            	|  1              	|  0.0            	|  0.0            	|
|  [LightningModule]Toymodel.teardown                                                                                                                                     	|  0.0            	|  1              	|  0.0            	|  0.0            	|
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
